<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <title>Renae and David Get Hitched!</title>
    <style>

#vhs-box
{
    height: 100vh;
    left: calc(50vw - 27.7vh);
    position: absolute;
    z-index: 1;
}

#vhs-tape
{
  transform: rotate(-90deg);
  width: 100vh;
  left: calc(50vw - 49vh);
  top: calc(50vh - 27.7vh);
  position: absolute;
  z-index: 0;
}

#vhs-tape.put-back
{
  animation: tape 3s reverse both;
}

#vhs-box.put-back
{
  animation: box 3s reverse both;
}

#open-box
{
  position: absolute;
  visibility: hidden;
}

#open-box:checked + label #vhs-box
{
  animation: box 3s both;
}

#open-box:checked + label #vhs-tape
{
  animation: tape 3s both;
}

#vhs-tape.animation-done
{
  transform: rotate(0deg) scale(1.25);
  z-index: 2;
}

@keyframes tape {
  0% {
    z-index: 0;
  }

  33% {
    transform: rotate(-90deg);
    left: calc(50vw + 10vh);
  }

  50% {
    z-index: 2;
  }

  56% {
    transform: rotate(0deg);
    left: calc(50vw);
    }

 66% {
    top: calc(50vh - 27.7vh);
    left: calc(50vw - 50vh);
    width: 100vh;
  }

  100%
  {
    transform: rotate(0deg) scale(1.25);
    z-index: 2;
  }
}

#vhs-box.animation-done
{
  filter: sepia(100%);
}

@keyframes box {
  75% {
    filter: sepia(0%);
  }

  100%
  {
    filter: sepia(100%);
  }
}

#hint
{
  position: absolute;
  top: 19vh;
  left: 34vw;
  width: 20vw;
  border-radius: 100%;
  padding: 7vw;
  text-align: center;
  z-index: 1;
  font-size: 7vw;
  background-image: radial-gradient(white, transparent);
  visibility: hidden;
}

#hint.fade-in
{
  visibility: visible;
  animation: fade 1s 5s both;
}

#hint.fade-out
{
  visibility: visible;
  animation: fade 1s reverse both;
}

#hint.animation-done
{
  opacity: 1;
  visibility: visible;
}

@keyframes fade
{
  from
  {
    opacity: 0;
  }

  to
  {
    opacity: 1;
  }
}

    </style>
  </head>
  <body>

<input type="checkbox" id="open-box">
<label for="open-box">
<img src="wedding2.png" id="vhs-tape">
<img src="wedding1.png" id="vhs-box">
<div class="fade-in" id="hint">Click to Open</div>
</label>



<script>
  const cb = document.querySelector("#open-box");
  const label = document.querySelector("label");
  const tape = document.querySelector("#vhs-tape");
  const box = document.querySelector("#vhs-box");
  const hint = document.querySelector("#hint");

  //let hint_shown = false;

  hint.classList.add("fade-in");

  hint.addEventListener("animationend",
  () =>
  {
    if (hint.classList.contains("fade-in"))
    {
      hint.classList.remove("fade-in");
      hint.classList.add("animation-done");
      //hint_shown = true;
    }

    if (hint.classList.contains("fade-out"))
    {
      hint.classList.remove("fade-out");
    }
  });
  
  label.addEventListener("pointerdown",
  e =>
  {
    console.log("PD");
    hint.classList.remove("fade-in");
    if (hint.classList.contains("animation-done"))
      setTimeout(
        () =>
        {
          hint.classList.add("fade-out");
          hint.classList.remove("animation-done");
        });
  });
  
  tape.addEventListener("animationend",
    e =>
    {
      console.log("AD");
      if (cb.checked)
      {
        tape.classList.add("animation-done");
        box.classList.add("animation-done");
      }
      else
      {
        tape.classList.remove("put-back");
        box.classList.remove("put-back");
      }
    });

  cb.addEventListener("click",
    e =>
    {
      console.log(e);
      if (!e.target.checked)
      {
        setTimeout(
          () =>
          {
            tape.classList.add("put-back");
            box.classList.add("put-back");
            tape.classList.remove("animation-done");
            box.classList.remove("animation-done");
          },
          /*
          100
          */
        );
      }
      else
      {
        tape.classList.remove("put-back");
        box.classList.remove("put-back");
      }
    });
</script>

  </body>
</html>
